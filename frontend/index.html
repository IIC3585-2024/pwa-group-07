<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#012650">
    <title>Notewes</title>
    <link rel="icon" href="images/favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="manifest" href="manifest.json">
</head>
<body class="flexbox">
    <main class="container text-center">
        <h1 class="title text-center"><img class="title-img" src="./images/notes-logo.jpg"> Notewes</h1>
        <div id="notebookSection">
            <div class="flexbox">
                <input class="flex inline-block" type="text" id="notebookInput" style="font-size: 30px;" placeholder="Escribe aquí...">
                <button class="inline-block" onclick="addNotebook()"><span style="font-size: 30px;">↵</span></button>
            </div>
            <p class="text-center">Escribe el nombre de un <i class="blue">Cuaderno de Notas</i> nuevo o ya existente</p>
        </div>
    </main>
    <script type="module" src="scripts/app.js"></script>
    <script>
        function requestPermission() {
            console.log('Requesting permission...');
            Notification.requestPermission().then((permission) => {
                if (permission === 'granted') {
                    console.log('Notification permission granted.');
                } else {
                    console.log('Unable to get permission to notify.');
                }
            });
        }
        requestPermission();
        if ('serviceWorker' in navigator) {
            // window.addEventListener('load', () => {
                navigator.serviceWorker.register('firebase-messaging-sw.js')
                    .then(reg => {
                        console.log('Firebase service worker registered.', reg);
                    });
            // });
        }
    </script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-analytics.js";
        import {
            getMessaging,
            getToken,
            onMessage,
        } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-messaging.js";
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyDi_Ku4d07op7w8v4Nh8VdPEQ72g-iREC8",
          authDomain: "pwa-g7.firebaseapp.com",
          projectId: "pwa-g7",
          storageBucket: "pwa-g7.appspot.com",
          messagingSenderId: "12229005519",
          appId: "1:12229005519:web:a2e6761d10bca20e3167ba",
          measurementId: "G-JPDQW9S45S"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const messaging = getMessaging(app);
        getToken(messaging, {
            vapidKey: 
                "BO4ruaq8L9n0N2HksdkvZ9jSO9OGFOUl6xQeVsrCpez8Ud_ZLyy-WMUWnU5GAVKSicwXOqkCafZkLP_gmPBT4b8"
        })
        .then((currentToken) => {
            if (currentToken) {
                console.log("current token for client: ", currentToken);
            } else {
                // Show permission request UI
                console.log(
                    "No registration token available. Request permission to generate one."
                );
            }
        })
        .catch((err) => {
            console.log("An error occurred while retrieving token. ", err);
        });
    </script>
</body>
</html>
